<?php

declare(strict_types=1);

namespace LaravelAIEngine\Enums;

/**
 * Action Type enumeration class (PHP 8.0 compatible)
 * Replaces native enum for Laravel 9 compatibility
 */
class ActionTypeEnum
{
    public const BUTTON = 'button';
    public const LINK = 'link';
    public const FORM = 'form';
    public const QUICK_REPLY = 'quick_reply';
    public const FILE_UPLOAD = 'file_upload';
    public const CONFIRM = 'confirm';
    public const MENU = 'menu';
    public const CARD = 'card';
    public const CAROUSEL = 'carousel';
    public const LIST = 'list';
    public const CALENDAR = 'calendar';
    public const LOCATION = 'location';
    public const PAYMENT = 'payment';
    public const SHARE = 'share';
    public const DOWNLOAD = 'download';
    public const COPY = 'copy';
    public const VOTE = 'vote';
    public const RATING = 'rating';
    public const SURVEY = 'survey';
    public const CUSTOM = 'custom';

    public string $value;

    public function __construct(string $value)
    {
        $this->value = $value;
    }

    /**
     * Get action type description
     */
    public function description(): string
    {
        switch($this->value) {
            case self::BUTTON:
                return 'Clickable button that triggers an action';,
            case self::LINK:
                return 'Navigation link to internal or external URL';,
            case self::FORM:
                return 'Interactive form with input fields';,
            case self::QUICK_REPLY:
                return 'Pre-defined quick response option';,
            case self::FILE_UPLOAD:
                return 'File upload interface';,
            case self::CONFIRM:
                return 'Confirmation dialog with yes/no options';,
            case self::MENU:
                return 'Dropdown menu with multiple options';,
            case self::CARD:
                return 'Rich card with content and embedded actions';,
            case self::CAROUSEL:
                return 'Horizontal scrollable card collection';,
            case self::LIST:
                return 'Vertical list of selectable items';,
            case self::CALENDAR:
                return 'Date/time picker interface';,
            case self::LOCATION:
                return 'Location picker or map interface';,
            case self::PAYMENT:
                return 'Payment processing interface';,
            case self::SHARE:
                return 'Social sharing options';,
            case self::DOWNLOAD:
                return 'File download action';,
            case self::COPY:
                return 'Copy text to clipboard';,
            case self::VOTE:
                return 'Voting interface (thumbs up/down, stars)';,
            case self::RATING:
                return 'Rating scale (1-5 stars, 1-10 scale)';,
            case self::SURVEY:
                return 'Multi-question survey form';,
            case self::CUSTOM:
                return 'Custom action type with developer-defined behavior';
        }
    }

    /**
     * Get required data fields for this action type
     */
    public function requiredFields(): array
    {
        switch($this->value) {
            self::BUTTON => ['action'],
            self::LINK => ['url'],
            self::FORM => ['fields'],
            self::QUICK_REPLY => ['message'],
            self::FILE_UPLOAD => ['allowed_types'],
            self::CONFIRM => ['confirm_action', 'cancel_action'],
            self::MENU => ['options'],
            self::CARD => ['title', 'content'],
            self::CAROUSEL => ['cards'],
            self::LIST => ['items'],
            self::CALENDAR => ['date_format'],
            self::LOCATION => ['map_provider'],
            self::PAYMENT => ['amount', 'currency'],
            self::SHARE => ['content'],
            self::DOWNLOAD => ['file_url'],
            self::COPY => ['text'],
            self::VOTE => ['vote_type'],
            self::RATING => ['scale', 'min_value', 'max_value'],
            self::SURVEY => ['questions'],
            self::CUSTOM => ['handler']
        }
    }

    /**
     * Get optional data fields for this action type
     */
    public function optionalFields(): array
    {
        switch($this->value) {
            self::BUTTON => ['icon', 'variant', 'size'],
            self::LINK => ['target', 'external', 'icon'],
            self::FORM => ['method', 'validation', 'submit_text'],
            self::QUICK_REPLY => ['auto_send', 'icon'],
            self::FILE_UPLOAD => ['max_size', 'multiple', 'preview'],
            self::CONFIRM => ['title', 'icon', 'variant'],
            self::MENU => ['multiple', 'searchable', 'placeholder'],
            self::CARD => ['image_url', 'actions', 'footer'],
            self::CAROUSEL => ['auto_scroll', 'indicators'],
            self::LIST => ['multiple', 'searchable', 'icons'],
            self::CALENDAR => ['min_date', 'max_date', 'time_picker'],
            self::LOCATION => ['default_location', 'zoom_level'],
            self::PAYMENT => ['description', 'metadata'],
            self::SHARE => ['platforms', 'title', 'description'],
            self::DOWNLOAD => ['filename', 'file_type'],
            self::COPY => ['success_message'],
            self::VOTE => ['allow_change', 'show_results'],
            self::RATING => ['labels', 'show_value'],
            self::SURVEY => ['title', 'description', 'submit_text'],
            self::CUSTOM => ['config', 'metadata']
        }
    }

    /**
     * Check if action type supports multiple instances
     */
    public function supportsMultiple(): bool
    {
        switch($this->value) {
            self::BUTTON, self::LINK, self::QUICK_REPLY, self::CARD => true,
            self::FORM, self::FILE_UPLOAD, self::CONFIRM, self::MENU,
            self::CAROUSEL, self::LIST, self::CALENDAR, self::LOCATION,
            self::PAYMENT, self::SHARE, self::DOWNLOAD, self::COPY,
            self::VOTE, self::RATING, self::SURVEY, self::CUSTOM => false
        }
    }

    /**
     * Check if action type requires user interaction
     */
    public function requiresInteraction(): bool
    {
        switch($this->value) {
            self::LINK, self::DOWNLOAD, self::COPY, self::SHARE => false,
            default => true
        }
    }

    /**
     * Get default style configuration for action type
     */
    public function defaultStyle(): array
    {
        switch($this->value) {
            self::BUTTON => [
                'variant' => 'primary',
                'size' => 'medium',
                'full_width' => false
            ],
            self::LINK => [
                'variant' => 'link',
                'underline' => true,
                'color' => 'blue'
            ],
            self::FORM => [
                'layout' => 'vertical',
                'spacing' => 'medium',
                'border' => true
            ],
            self::QUICK_REPLY => [
                'variant' => 'outline',
                'size' => 'small',
                'rounded' => true
            ],
            self::FILE_UPLOAD => [
                'variant' => 'dashed',
                'size' => 'large',
                'drag_drop' => true
            ],
            self::CONFIRM => [
                'variant' => 'modal',
                'size' => 'medium',
                'backdrop' => true
            ],
            self::MENU => [
                'variant' => 'dropdown',
                'size' => 'medium',
                'searchable' => false
            ],
            self::CARD => [
                'variant' => 'elevated',
                'border_radius' => 'medium',
                'shadow' => 'small'
            ],
            default => []
        }
    }

    /**
     * Get all available action types
     */
    public static function all(): array
    {
        return [
            self::BUTTON,
            self::LINK,
            self::FORM,
            self::QUICK_REPLY,
            self::FILE_UPLOAD,
            self::CONFIRM,
            self::MENU,
            self::CARD,
            self::CAROUSEL,
            self::LIST,
            self::CALENDAR,
            self::LOCATION,
            self::PAYMENT,
            self::SHARE,
            self::DOWNLOAD,
            self::COPY,
            self::VOTE,
            self::RATING,
            self::SURVEY,
            self::CUSTOM,
        ];
    }

    /**
     * Get all available action type instances
     */
    public static function cases(): array
    {
        return array_map(fn($value) => new self($value), self::all());
    }

    /**
     * Create action type from value
     */
    public static function from(string $value): self
    {
        if (!in_array($value, self::all())) {
            throw new \InvalidArgumentException("Invalid action type value: {$value}");
        }
        return new self($value);
    }
}
